<yata-view-header></yata-view-header>
<main>
  <div class="create-task-container">
    <yata-create-task></yata-create-task>
  </div>

  <div class="sections-wrapper" cdkDropListGroup>
    <!-- Unsectioned tasks -->
    <ng-container *ngIf="unsectionedTasks$ | async as unsectionedTasks">
      <ng-container *ngIf="unsectionedTasks.length">
        <yata-section
          [name]="'Unsectioned'"
          [itemsCount]="unsectionedTasks.length"
        >
          <yata-task-list
            #list
            cdkDropList
            (cdkDropListDropped)="list.handleDropped($event)"
          >
            <yata-task
              *ngFor="let task of unsectionedTasks"
              [task]="task"
              cdkDrag
              [cdkDragData]="task"
            >
              <yata-task-options-menu [task]="task"></yata-task-options-menu
            ></yata-task>
          </yata-task-list>
        </yata-section>
      </ng-container>
    </ng-container>

    <div *ngIf="sections$ | async as sections">
      <!-- Project sections -->
      <ng-container *ngFor="let section of sections">
        <yata-project-section [section]="section"></yata-project-section>
      </ng-container>

      <!-- Completed sections -->
      <ng-container *ngIf="completedTasks$ | async as completedTasks">
        <ng-container *ngIf="completedTasks && completedTasks.length > 0">
          <yata-section
            [name]="'Completed'"
            [itemsCount]="completedTasks.length"
          >
            <yata-task-list>
              <yata-task
                *ngFor="let task of completedTasks"
                [task]="task"
              ></yata-task>
            </yata-task-list>
          </yata-section>
        </ng-container>
      </ng-container>
    </div>
  </div>
</main>
