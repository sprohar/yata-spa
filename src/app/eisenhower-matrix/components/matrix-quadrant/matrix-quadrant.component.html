<mat-card class="quadrant">
  <div class="quadrant-header">
    <h5 [ngClass]="textColorClassName">
      {{ headerText }}
    </h5>

    <div class="quadrant-header-actions">
      <button mat-icon-button (click)="openCreateTaskDialog()">
        <mat-icon>add</mat-icon>
      </button>
      <button mat-icon-button [matMenuTriggerFor]="quadrantOptions" title="Quadrant options">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #quadrantOptions>
        <button mat-menu-item (click)="showCompleted = !showCompleted">
          {{ showCompleted ? "Hide" : "Show" }} completed
        </button>
      </mat-menu>
    </div>
  </div>

  <!-- Content -->
  <div class="full-height p-1 relative">
    <div class="quadrant-content" *ngIf="projects$ | async as projects">
      <ng-container *ngFor="let project of projects">
        <ng-container *ngIf="getProjectTasks(project) as tasks">
          <yata-section *ngIf="tasks.length" [name]="project.name" [itemsCount]="tasks.length">
            <yata-task-list cdkDropList (cdkDropListDropped)="handleTaskDropped($event)"
              [cdkDropListData]="{ projectId: project.id!, priority: priority }">
              <yata-task *ngFor="let task of tasks" cdkDrag [cdkDragData]="task" [task]="task">
                <span class="task-info">{{ task.dueDate | date }}</span>
                <yata-task-options-menu [task]="task"></yata-task-options-menu>
              </yata-task>
            </yata-task-list>
          </yata-section>
        </ng-container>
      </ng-container>

      <ng-container *ngIf="completedTasks?.length && showCompleted">
        <yata-section [name]="'Completed'" [itemsCount]="completedTasks?.length">
          <yata-task-list>
            <yata-task *ngFor="let task of completedTasks" [task]="task">
              <yata-task-options-menu [task]="task"></yata-task-options-menu>
            </yata-task>
          </yata-task-list>
        </yata-section>
      </ng-container>
    </div>
  </div>
</mat-card>
